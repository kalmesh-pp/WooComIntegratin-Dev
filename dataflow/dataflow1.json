{
	"name": "dataflow1",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "PP_SyncUpAll_Orders",
						"type": "DatasetReference"
					},
					"name": "source1"
				}
			],
			"sinks": [],
			"transformations": [
				{
					"name": "Join1"
				}
			],
			"script": "source(output(\n\t\tID as integer,\n\t\tWC_CustomerBillToID as string,\n\t\tWC_CustomerShipToID as string,\n\t\tWC_OrderID as string,\n\t\tWC_ShipCode as string,\n\t\tWC_Freight as decimal(18,0),\n\t\tWC_Slsman as string,\n\t\tWC_OrderCode as string,\n\t\tWC_Sold_to_Email as string,\n\t\tWC_Order_Date as timestamp,\n\t\tWC_Note as string,\n\t\tWC_PaymentMethod as string,\n\t\tWC_OrderTax as decimal(18,0),\n\t\tWC_OrderTotal as decimal(18,0),\n\t\tWC_OrderRefund as decimal(18,0),\n\t\tWC_OrderSubTotal as decimal(18,0),\n\t\tWC_Shipping_Method_Title as string,\n\t\tQueueStatusID as integer,\n\t\tCreated_Date as timestamp,\n\t\tCreatedBy as string,\n\t\tModified_Date as timestamp,\n\t\tModifyBy as string,\n\t\tSytelineOrderNumber as string,\n\t\tSytelineTrackingNumber as string,\n\t\tSytelineShipCode as string,\n\t\tSytelineCarrierName as string,\n\t\tSytelineOrderStatus as string,\n\t\tSytelineActualShipDate as timestamp,\n\t\tSyncupDate as timestamp,\n\t\tSyncupRequired as boolean\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'SELECT orders.Order_id as order_id,\\n\torders.Customer_id as customer_id,\\n\torders.Order_status as order_status,\\n\torders.Due_date,\\n\torders.Created_date,\\n\torders.Order_total,\\n\torders.Line_subtotal,\\n\torders.Shipping_total,\\n\torders.Tax_total,\\n\torders.Billing_email,\\n\torders.Billing_phone,\\n\torders.Billing_firstname,\\n\torders.Billing_lastname,\\n\torders.Billing_address_1, \\n\torders.Billing_address_2, \\n\torders.Billing_city,\\n\torders.Billing_state,\\n\torders.Billing_postcode,\\n\torders.Shipping_firstname,\\n\torders.Shipping_lastname,\\n\torders.Shipping_address_1,\\n\torders.Shipping_address_2,\\n\torders.Shipping_city,\\n\torders.Shipping_state,\\n\torders.shipping_provider,\\n\t( SELECT products.ProductName, \tproducts.SKU,\tproducts.Price,\tproducts.Qty, \tproducts.SubTotal\\n\t\tfrom dbo.All_OrderItems products\\n\t\twhere products.Co_num = orders.Order_id\\n\t\tfor JSON AUTO ) as products\\nFROM [dbo].All_Orders orders \\n',\n\tformat: 'query') ~> source1\nsource1 join(WC_OrderID == ERROR_FUNCTION(''),\n\tjoinType:'left',\n\tbroadcast: 'auto')~> Join1"
		}
	}
}